version: 0.2

phases:
  pre_build:
    commands:
      - | 
        GIT_BRANCH="$(git rev-parse HEAD | xargs git name-rev | cut -d' ' -f2 | sed 's/remotes\/origin\///g')";
        
      - echo $GIT_BRANCH

  build:
    commands:
      - |
        if [ "$GIT_BRANCH" = "main" ]; then
          echo "Building for main branch"
          echo "Build started on $(date)"
          newimagename=rl-branch-test-main
          echo $newimagename
        fi

artifacts:
  files: imagedefinitions.json